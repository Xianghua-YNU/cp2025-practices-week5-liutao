# 泊松分布数值模拟实验报告

## 1. 实验目的
描述本实验的主要目标，包括：
- 理解泊松分布的基本性质
- 通过硬币实验验证泊松分布
- 比较实验结果与理论预测的差异

## 2. 理论基础

### 2.1 泊松分布
- 泊松分布的定义和概率质量函数
- λ参数的物理意义
- 泊松分布的期望和方差

### 2.2 实验模型
- 不公平硬币模型的设置（p = 0.08）
- 实验参数说明：
  - 单组实验抛硬币次数：100
  - λ = np = 8
  - 实验组数：N = 10000

## 3. 实验过程

### 3.1 理论分布绘制
[![Figure_1](https://github.com/user-attachments/assets/7678dd89-e61b-452b-92df-a03b4926956a)
]
- 描述图形特征：
 1. 基本形状
单峰的离散分布形状。它从 l = 0 开始，随着 l 值的增加，概率 p(l) 先上升至一个最大值，然后逐渐下降。
 2. 峰值位置
理论上峰值应该出现在 l = 8 附近
 3. 对称性
不对称的分布。当 λ 较小时（例如 λ < 10），分布呈现出右偏态，即右侧的尾巴较长。随着 λ 的增大，分布逐渐趋近于对称的正态分布。在代码中，由于 λ = 8，分布仍然有一定的右偏性，但已经比较接近对称。
 4. 衰减特性
随着 l 值的增加，概率 p(l) 逐渐衰减。
 5. 离散性
- 分析分布的主要特点：
 1.参数决定形状：泊松分布由一个参数 `λ`完全决定。`λ` 表示单位时间内事件发生的平均次数。不同的 `λ` 值会导致分布的形状和位置发生变化。
 2.值和方差相等：泊松分布的一个重要特性是其均值和方差都等于参数 `λ`。

### 3.2 数值模拟实验
- 实验流程说明
  本数值模拟实验旨在验证抛硬币实验的结果是否符合泊松分布，并比较实验结果与理论分布的差异。实验的具体流程如下：
1.初始化随机种子：为了保证实验的可重复性，使用 np.random.seed(42) 设置随机种子。
2.绘制理论分布：调用 plot_poisson_pmf 函数，根据给定的泊松分布参数 lambda_param（默认值为 8）和最大的 l 值 max_l（默认值为 20），计算并绘制泊松分布的概率质量函数（PMF）。
3.进行实验模拟：调用 simulate_coin_flips 函数，模拟多组抛硬币实验。每组实验包含 n_flips 次抛硬币（默认值为 100），正面朝上的概率为 p_head（默认值为 0.08），总共进行 n_experiments 组实验（默认值为 10000）。记录每组实验中正面朝上的次数。
4.比较实验结果与理论分布：调用 compare_simulation_theory 函数，将实验结果绘制成直方图，并与理论分布的曲线进行比较。同时，计算并打印实验结果的均值和方差，与理论值进行对比。
5.显示图形：使用 plt.show() 显示绘制的图形。
- 数据收集方法
  在实验中，数据收集主要通过 simulate_coin_flips 函数完成。具体步骤如下：
1.初始化一个空列表 results，用于记录每组实验中正面朝上的次数。
2.使用 for 循环进行 n_experiments 组实验。在每组实验中，使用 np.random.choice 函数模拟 n_flips 次抛硬币，根据 p_head 的概率3随机选择 0（反面）或 1（正面）。
3.计算每组实验中正面朝上的次数（即数组中 1 的个数），并将结果添加到 results 列表中。
4.将 results 列表转换为 numpy 数组并返回。
- 统计处理过程
  在实验中，统计处理主要在 compare_simulation_theory 函数中完成。具体步骤如下：
1.调用 simulate_coin_flips 函数进行实验模拟，得到每组实验中正面朝上的次数。
2.计算理论分布的概率质量函数（PMF）。根据泊松分布的公式，计算从 0 到 max_l 的每个 l 值对应的概率。其中，max_l 取 int(lambda_param * 2) 和 max(results) + 1 中的较大值。
3.绘制实验结果的直方图和理论分布的曲线。使用 plt.hist 函数绘制实验结果的直方图，设置 density=True 以显示频率 / 概率。使用 plt.plot 函数绘制理论分布的曲线。
4.计算并打印实验结果的均值和方差。使用 np.mean 和 np.var 函数分别计算实验结果的均值和方差，并与理论值 lambda_param 进行对比。

## 4. 实验结果分析

### 4.1 实验数据统计
- 样本均值：[8.02]（理论值：8）
- 样本方差：[7.45]（理论值：8）
- 分析与理论值的偏差

### 4.2 分布比较
[![Figure_2](https://github.com/user-attachments/assets/996f8d64-58cf-4c9c-b69c-2ce3103f65ce)]
分析以下方面：
- 直方图与理论曲线的拟合程度：
  在大量实验（n_experiments = 10000）的情况下，根据大数定律，实验结果会趋近于理论分布。从代码运行结果来看，如果直方图的柱子高度与理论曲线的高度相近，说明两者拟合较好，即抛硬币实验中正面朝上次数的分布符合泊松分布的理论模型。然而，由于实验的随机性，可能会存在一定的偏差，但总体趋势应该是相似的。
  
- 分布的对称性：
  对于 λ = 8，分布已经相对接近对称，但仍可能存在一定的右偏性。在直方图和理论曲线中，可以观察到右侧的尾巴可能会比左侧稍长。具体来说，事件发生次数大于 λ 的概率下降速度可能会比小于 λ 的概率上升速度稍慢。
    
- 峰值位置：
  在绘制的直方图和理论曲线中，峰值应该出现在 l 接近 lambda_param = 8 的位置。通过观察图形，可以验证这一特征。如果实验结果与理论相符，直方图中柱子最高的位置应该与理论曲线的峰值位置相近。
  
- 分布宽度
  如果实验方差接近理论值 λ = 8，说明实验结果的分布宽度与理论分布相符。分布宽度可以从直方图和理论曲线的形状直观地看出，较宽的分布意味着事件发生次数在更广泛的范围内都有一定的概率出现，而较窄的分布则表示事件发生次数更集中在期望值附近。

### 4.3 误差分析
讨论可能的误差来源：
- 随机波动的影响：
  随机波动会导致实验结果与理论分布之间存在一定的偏差。例如，在某一次实验中，正面朝上的次数可能会比理论值多一些，而在另一次实验中可能会少一些。这种偏差在样本量较小时会更加明显，因为随机因素对结果的影响相对较大
  

- 样本量的影响：
  当样本量较小时，实验结果的波动会更大，均值和方差可能会与理论值有较大的偏差。直方图与理论曲线的拟合程度也会变差，因为样本不能准确地反映总体的分布特征。随着样本量的增加，实验结果会逐渐稳定，趋近于理论分布。

  
- 其他可能的系统误差
 1 随机数生成器的局限性：代码中使用 np.random.choice 生成随机数，虽然 numpy 的随机数生成器是伪随机数生成器，在大多数情况下可以满足需求，但它仍然存在一定的局限性。例如，随机数序列可能存在周期性或相关性，这可能会对实验结果产生一定的影响。
  2理论模型的假设：泊松分布假设事件的发生是相互独立的，且在单位时间或空间内的平均发生率是恒定的。在实际的抛硬币实验中，可能存在一些因素违反了这些假设。例如，硬币的物理特性、抛硬币的方式等可能会导致每次抛硬币的结果之间存在一定的相关性，从而影响实验结果与理论分布的拟合程度。
  3参数估计的误差：在代码中，lambda_param 是根据 n_flips 和 p_head 计算得到的理论值（lambda_param = n_flips * p_head）。如果 p_head 的估计不准确，或者 n_flips 存在误差，那么 lambda_param 的值也会不准确，从而导致理论分布与实验结果之间的偏差。

## 5. 讨论与结论

### 5.1 主要发现
1. 实验结果与理论预期的符合程度
整体趋势：通过 compare_simulation_theory 函数，将抛硬币实验的模拟结果（直方图）与泊松分布的理论曲线进行了对比。从代码逻辑和结果展示来看，当实验次数 n_experiments 足够大（默认值为 10000）时，实验结果在整体趋势上与理论预期相符。这是因为根据大数定律，大量重复实验的结果会趋近于理论分布。
统计指标：代码中打印了实验均值和实验方差，并与理论值（泊松分布的参数 lambda_param，默认值为 8）进行了比较。如果实验均值和实验方差接近理论值，说明实验结果与理论预期在统计指标上是相符的。例如，若输出的实验均值和实验方差与 8 相差不大，就验证了泊松分布的均值和方差都等于其参数 λ 的特性。
2. 观察到的特殊现象
随机波动：由于实验是基于随机数生成器模拟抛硬币过程（np.random.choice），每次实验的结果都会存在一定的随机波动。即使设置了随机种子（np.random.seed(42)），在不同的运行环境或代码修改后重新运行时，结果仍可能有所不同。这种随机波动在样本量较小时会更加明显，可能导致实验结果与理论曲线之间存在一定的偏差。
分布形态：泊松分布在不同的 λ 值下具有不同的形态。当 λ 较小时，分布呈现右偏态；随着 λ 的增大，分布逐渐趋近于对称。在本实验中，λ = 8，分布已经相对接近对称，但仍可能存在一定的右偏性，可通过观察直方图和理论曲线的形状来发现这一特点。
3. 统计特性的验证
均值验证：泊松分布的均值等于其参数 λ。在实验中，通过计算多次抛硬币实验中正面朝上次数的平均值（np.mean(results)），并与理论值 lambda_param 进行比较。如果两者接近，就验证了泊松分布的这一统计特性。
方差验证：泊松分布的方差也等于其参数 λ。代码中计算了实验结果的方差（np.var(results)），并与理论值进行对比。若实验方差与理论值相近，说明实验结果符合泊松分布的方差特性。
### 5.2 实验改进建议
提出可能的改进方向：
- 样本量的选择
  动态调整样本量：当前代码中 n_experiments 固定为 10000，可通过编写一个函数根据实验结果的稳定性动态调整样本量。例如，多次运行较小样本量的实验，计算每次实验结果的均值和方差，当这些统计量的波动在可接受范围内时，停止增加样本量。
- 实验参数的优化
  调整抛硬币次数和正面概率：当前代码中 n_flips 固定为 100，p_head 固定为 0.08，可以通过网格搜索或随机搜索的方法，尝试不同的 n_flips 和 p_head 组合，找到使实验结果与理论分布拟合度最佳的参数组合
- 数据处理方法的改进
  使用更精确的拟合度评估指标：当前代码仅通过打印实验均值和方差与理论值的比较来评估实验结果与理论分布的拟合程度，可以使用更精确的统计指标，如卡方检验、柯尔莫哥洛夫 - 斯米尔诺夫检验等，来判断实验数据是否符合泊松分布

## 6. 参考资料
列出参考的文献和资料(如果有)：


