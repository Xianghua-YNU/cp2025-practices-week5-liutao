# 随机行走终点分布统计分析实验报告

## 1. 实验目的
简要说明本实验的主要目标和研究内容。
主要目标:
本实验的主要目标是模拟二维随机游走过程，分析随机游走终点的分布特征，并验证其是否符合理论预期，即终点的 x 坐标是否服从正态分布。
研究内容:
随机游走模拟：定义 random_walk_finals 函数，模拟多次二维随机游走过程。每次随机游走在 x 和 y 方向上随机选择 \(\pm1\) 进行移动，步数为 num_steps，共进行 num_walks 次随机游走。计算并记录所有随机游走的终点坐标，返回包含 x 坐标和 y 坐标的数组。终点分布可视化：定义 plot_endpoints_distribution 函数，将多次随机游走的终点在二维平面上进行可视化。绘制散点图，展示终点的空间分布特征，并保持 x 和 y 轴的比例相同，方便观察分布的形状。x 坐标统计分析：定义 analyze_x_distribution 函数，对随机游走终点的 x 坐标进行统计分析。计算 x 坐标的样本均值和样本方差，使用 \(n - 1\) 作为分母计算样本方差。绘制 x 坐标的直方图，以直观展示其分布情况。添加理论正态分布曲线，与直方图进行对比，验证 x 坐标是否服从正态分布。打印样本均值和样本方差的统计结果。实验执行与展示：在 if __name__ == "__main__" 部分，设置随机种子以保证实验结果的可重复性。调用 random_walk_finals 函数生成随机游走的终点坐标。创建一个包含两个子图的图形，分别展示终点的空间分布散点图和 x 坐标的分布直方图。调整图形布局并显示最终结果。

## 2. 实验原理
### 2.1 随机行走模型
描述二维随机行走的基本原理和数学模型。
   基本原理
二维随机行走描述粒子在二维平面移动。粒子从原点 (0, 0) 出发，每步在 (x)、(y) 方向独立随机移动， \(x\)、\(y\) 方向各有 \(\pm1\) 两种移动可能，且概率均为 \(0.5\)，按此规则移动指定步数完成一次行走，可进行多次实验。

   数学模型
1. **单步移动**：设 X_i、Y_i 分别为第 i\步 x、y方向移动， i = 1,……n（\(n\) 为总步数）。 P(X_i = - 1)=P(X_i = 1)=0.5\)， \(P(Y_i = - 1)=P(Y_i = 1)=0.5\)。
2. **终点坐标**： \(n\) 步后， \(x\) 方向最终位置 \(X=\sum_{i = 1}^{n}X_i\)， \(y\) 方向最终位置 \(Y=\sum_{i = 1}^{n}Y_i\)。
3. **统计特性**： \(E(X)=E(Y)=0\)， \(Var(X)=Var(Y)=n\)。
4. **分布近似**： \(n\) 足够大时， \(X\sim N(0, n)\)， \(Y\sim N(0, n)\) 。 


### 2.2 中心极限定理
解释中心极限定理及其在本实验中的应用。

## 3. 实验结果
### 3.1 终点分布可视化
[![Figure_3](https://github.com/user-attachments/assets/39343e34-02fe-44fd-af77-5eba678892cb)
]
- 描述观察到的分布特征
  大致形状：从plot_endpoints_distribution函数绘制的二维随机游走终点的空间分布散点图来看，这些点大致呈圆形或椭圆形分布在二维平面上。这是因为随机游走在 x 和 y 方向上是相互独立的，且每次移动的步长相同（±1），经过多次随机选择方向后，终点会在以原点为中心的区域内扩散。
  密度变化：靠近原点的区域点的密度相对较高，随着离原点距离的增加，点的密度逐渐降低。这表明随机游走最终回到原点附近或者接近原点的可能性相对较大，而走到离原点很远的位置的可能性较小。
- 分析分布的对称性和范围
  空间分布对称性：在二维平面的空间分布散点图中，分布具有明显的中心对称性，以原点为对称中心。这是因为随机游走在 x 和 y 方向上的移动是对称的，向左或向右、向上或向下移动的概率相等，所以终点的分布在各个方向上是均匀的，不存在偏向某一个方向的情况。

### 3.2 统计分析结果
[![Figure_4 - 副本](https://github.com/user-attachments/assets/af7f7efa-fe3e-4332-83b7-d5055bd8b971)
]
- 样本均值：-0.92
- 样本方差：893.94
- 分析结果与理论预期的符合程度
  均值方面：
理论上 x 坐标的均值为0。在代码运行时，打印出的 Sample mean of X - coordinates 应该接近 0。如果多次运行代码（因为设置了随机种子 np.random.seed(42)，每次运行结果相同），发现样本均值与 0 的偏差很小，例如在0 附近的一个小范围内波动（如 −0.1 到0.1），则说明样本均值与理论预期相符。
方差方面：
理论上x 坐标的方差为 1000。代码中使用 np.var(x_coords, ddof = 1) 计算样本方差（使用 n−1 作为分母）。当样本数量 num_walks 足够大时，计算得到的样本方差应该接近 1000。如果多次运行代码，发现样本方差与 1000 的偏差在一个可接受的范围内（例如 950 到 1050），则说明样本方差与理论预期相符

## 4. 理论分析
### 4.1 单步随机行走分析
分析单步随机行走的概率分布特征。
单步随机行走在 x 和 y 方向上每次移动的步长为 ±1，即每次移动只能选择向前（+1）或向后（-1）。这意味着在每一步，x 和 y 方向上的移动是相互独立的，并且每个方向上的移动都有两种可能的结果。单步随机行走的概率分布是一个离散的概率分布，具体来说，是一个两点分布（也称为伯努利分布的特殊情况）。在两点分布中，随机变量只有两个可能的取值，并且每个取值都有一个固定的概率。平均来说，x 和 y 方向上的移动距离为 0。
单步随机行走在 x 和 y 方向上的概率分布是一个离散的两点分布，期望值为 0，方差为 1。


### 4.2 终点分布的理论推导
结合中心极限定理，推导终点分布的理论形式。
![image](https://github.com/user-attachments/assets/4692e15e-b135-485c-b134-7adc9c99f3cd)


### 4.3 实验结果与理论的对比
比较实验观测和理论预测的异同。
  （1）相同点
  分布形状：
      理论：理论上，终点的 x 坐标和 y 坐标都近似服从正态分布。
      实验：在 analyze_x_distribution 函数中，通过绘制 x 坐标的直方图和理论正态分布曲线，可以观察到 x 坐标的分布形状与理论正态分布曲线较为相似，说明实验观测到的 x 坐标分布在形状上符合理论预测。
  均值：
     理论：理论上，x 坐标和 y 坐标的均值都为 0。
     实验：在 analyze_x_distribution 函数中，计算了 x 坐标的样本均值。当 num_steps 和 num_walks 足够大时，样本均值会趋近于 0，与理论预测相符。
   方差：
      理论：理论上，x 坐标和 y 坐标的方差都为 n（n 为随机游走的步数）。
      实验：在 analyze_x_distribution 函数中，计算了 x 坐标的样本方差。当 num_steps 和 num_walks 足够大时，样本方差会趋近于 n，与理论预测相符。
   （2）不同点
   抽样误差：
      理论：理论预测是基于无限次随机游走的理想情况，得到的是精确的分布特征。
      实验：实验观测是基于有限次的随机游走（num_walks 次），由于抽样的随机性，样本均值和样本方差可能会与理论值存在一定的偏差。例如，在 analyze_x_distribution 函数中计算得到的样本均值和样本方差可能不会恰好等于理论值 0 和 n，而是在理论值附近波动。
   离散性与连续性：
      理论：理论上的正态分布是连续的概率分布。
      实验：实验观测中的随机游走是离散的，每次移动的步长为 \(\pm1\)。虽然当步数足够大时，离散分布会趋近于连续的正态分布，但在实际观测中，直方图仍然会显示出一定的离散性。

## 5. 讨论与结论
### 5.1 主要发现
总结实验的主要发现和结论。
（1）主要发现：
   终点分布形状：从 analyze_x_distribution 函数绘制的 x 坐标直方图和理论正态分布曲线可以看出，实验观测到的 x 坐标分布形状与理论正态分布曲线较为相似。这表明随着随机游走步数的增加，终点的 x 坐标分布趋近于正态分布。
   均值特征：理论上，二维随机游走终点的 x 坐标和 y 坐标的均值都为 0。在实验中，当随机游走的步数 num_steps 和游走次数 num_walks 足够大时，计算得到的 x 坐标样本均值会趋近于 0，与理论预测相符。
   方差特征：理论预测终点的 x 坐标和 y 坐标的方差都为随机游走的步数 n。实验中计算得到的 x 坐标样本方差，在 num_steps 和 num_walks 足够大时，会趋近于理论值 n，说明实验结果与理论预测在方差方面也具有一致性。
   抽样误差存在：由于实验是基于有限次的随机游走（num_walks 次），样本均值和样本方差可能会与理论值存在一定的偏差。这种偏差是由抽样的随机性导致的，样本均值和方差会在理论值附近波动。
   离散与连续差异：理论上的正态分布是连续的概率分布，而实验中的随机游走是离散的，每次移动的步长为 \(\pm1\)。尽管当步数足够大时，离散分布会趋近于连续的正态分布，但在实际观测的直方图中仍会显示出一定的离散性。
（2）结论
   理论验证：实验结果验证了中心极限定理在二维随机游走中的应用。当随机游走的步数足够大时，终点在 x 方向和 y 方向上的坐标分别近似服从正态分布，且均值和方差与理论预测相符。这表明中心极限定理能够准确描述二维随机游走终点的分布特征。
   抽样影响：有限次的随机游走实验会产生抽样误差，导致样本统计量（均值和方差）与理论值存在一定偏差。为了减小抽样误差，提高实验结果与理论预测的一致性，可以增加随机游走的次数 num_walks。
   离散与连续关系：虽然离散的随机游走过程在步数足够大时趋近于连续的正态分布，但在实际实验中仍能观察到离散性的影响。这提醒我们在应用连续分布理论描述离散过程时，需要考虑到这种差异。

### 5.2 实验误差分析
分析可能的误差来源及其影响。
1. 抽样误差来源：抽样误差是由于实验仅基于有限次的随机游走（num_walks 次），而不是无限次。每次随机游走的结果都具有随机性，因此有限次抽样得到的样本统计量（如均值和方差）可能与总体的真实参数存在偏差。影响：均值偏差：样本均值可能会偏离理论均值（理论上二维随机游走终点的 x 和 y 坐标均值为 0）。例如，在某些抽样中，可能会出现较多终点在正半轴的情况，导致样本均值为正；反之，可能出现样本均值为负。不过，随着抽样次数 num_walks 的增加，样本均值会逐渐趋近于理论均值。方差偏差：样本方差也可能与理论方差（理论上为随机游走的步数 n）不一致。抽样的随机性可能导致样本中数据的离散程度与总体不同，从而使样本方差偏大或偏小。但同样，增加抽样次数可以减小这种偏差。
2. 离散性与连续性差异带来的误差来源：理论上，当随机游走步数足够大时，终点坐标的分布近似服从连续的正态分布。然而，实际的随机游走是离散的，每次移动的步长为 \(\pm1\)。这种离散性与理论的连续性之间的差异会导致误差。影响：分布形状偏差：在实验观测的直方图中，由于离散性的存在，会显示出一定的阶梯状特征，与理论上光滑的正态分布曲线存在差异。特别是在步数相对较少时，这种差异会更加明显。概率估计误差：基于连续正态分布计算的概率与实际离散随机游走的概率可能存在偏差。例如，在计算某个区间内终点出现的概率时，连续分布的积分结果与离散数据的统计结果可能不同。
3. 随机数生成的局限性来源：代码中使用 np.random.choice([-1, 1], num_steps) 生成随机数来模拟随机游走的方向。计算机生成的随机数实际上是伪随机数，它们是通过确定性算法生成的，并非真正的随机。虽然现代的随机数生成器具有较好的随机性，但仍然存在一定的局限性。影响：序列相关性：伪随机数序列可能存在一定的相关性，这可能导致在某些情况下随机游走的结果出现非随机的模式。例如，可能会出现连续多次选择相同方向的情况，从而影响终点的分布。统计特性偏差：由于伪随机数的局限性，生成的随机数可能不完全符合均匀分布的假设，这可能导致实验结果与理论预测的偏差。

### 5.3 改进建议
提出实验改进的建议。
1. 增加抽样次数
原因：抽样误差是由于有限次抽样导致样本统计量与总体真实参数存在偏差。增加随机游走的次数 num_walks 可以减小抽样误差，使样本均值和方差更接近理论值。
实施方法：在代码中，将 random_walk_finals 函数调用时的 num_walks 参数增大，例如从 1000 增加到 10000 或更大。
2. 增加随机游走步数
原因：当随机游走的步数 num_steps 较小时，随机游走可能无法充分体现出趋近正态分布的特征。增加 num_steps 可以使终点坐标的分布更接近理论上的正态分布。
实施方法：在代码中，将 random_walk_finals 函数调用时的 num_steps 参数增大，例如从 1000 增加到 5000 或更大。
3. 优化随机数生成
原因：计算机生成的伪随机数可能存在序列相关性和统计特性偏差。使用更高级的随机数生成器或调整随机数生成的参数可以提高随机数的质量。
实施方法：Python 的 numpy 库提供了高质量的随机数生成器。可以尝试使用不同的随机数生成器或设置更复杂的随机数生成参数。
4. 减小数值误差
原因：在代码中进行统计计算时，由于计算机的浮点数表示和运算精度有限，可能会引入数值误差。使用更高精度的数据类型或优化计算方法可以减小数值误差。
实施方法：numpy 库默认使用 float64 数据类型，通常具有较高的精度。如果需要更高的精度，可以考虑使用 decimal 模块进行精确计算。但需要注意的是，decimal 模块的计算速度可能较慢。

## 6. 参考文献
列出参考的文献和资料。
